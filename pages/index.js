import Head from "next/head";
import Image from "next/image";
import BackgroundImage from "../components/cards/backgroundImageCard";
import DetailsCard from "../components/cards/detailsCard";
import OtherCollections from "../components/otherCollections/otherCollections";
import Hero from "../components/hero/hero";
import PopularProducts from "../components/popularProducts/popularProducts";
import {
  getBanner,
  getCollectionsCategories,
  getOtherCollections,
  getPopularProducts,
} from "./api/apis";
import CountryLeagueCollection from "../components/countryLeagueCollection/countryLeagueCollection";
import SpecialTournamentsCollection from "../components/countryLeagueCollection/countryLeagueCollection";
import { motion, useIsPresent } from "framer-motion";

export default function Home({
  banners,
  collectionsCategories,
  popularProducts,
  otherCollections,
}) {
  const isPresent = useIsPresent();

  return (
    <div className="">
      <Head>
        <title>Home</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <div className="lg:space-y-10 lg:p-10">
        <Hero banners={banners} />
        <div className="grid w-full grid-cols-2 gap-4 p-4 lg:h-40 lg:grid-cols-4 lg:p-0">
          <DetailsCard
            icon="truck"
            topic="Secure Shipping"
            body="on all orders"
          />
          <DetailsCard icon="phone" topic="Telephone" body="+1 23 456 7890" />
          <DetailsCard
            icon="whatsapp"
            topic="Chat WhatsApp"
            body="Mon – Fri: 9:00 – 21:00  •  Sat – Sun: 9:00 – 17:00"
          />
          <DetailsCard
            icon="check-badge"
            topic="Quality Guarantee"
            body="Verified Purchase Reviews"
          />
        </div>
      </div>
      <div className=" w-40 fixed h-14 z-20">
        <Image
          src="/assets/icons/svg/rewards-badge.svg"
          alt="rewards badge"
          layout="fill"
        />
      </div>
      <div className="relative px-4 py-3 pb-20 space-y-20 lg:p-20">
        <PopularProducts data={popularProducts} />
        <CountryLeagueCollection
          data={collectionsCategories.data.filter(
            (categories) => categories.title === "Country Leagues"
          )}
        />
        <SpecialTournamentsCollection
          data={collectionsCategories.data.filter(
            (categories) => categories.title === "Special Tournaments"
          )}
        />
        <OtherCollections data={otherCollections} />
        <section className="w-full ">
          <BackgroundImage />
        </section>
      </div>
      <motion.div
        initial={{ scaleX: 1 }}
        animate={{
          scaleX: 0,
          transition: { duration: 0.9, ease: "circOut" },
        }}
        exit={{ scaleX: 1, transition: { duration: 0.9, ease: "circIn" } }}
        style={{ originX: isPresent ? 0 : 1 }}
        className="fixed top-0 left-0 right-0 bottom-0 bg-yellow-300 z-[100]"
      />
    </div>
  );
}

export async function getStaticProps() {
  const banners = await getBanner().then((res) => res.banners);
  const collectionsCategories = await getCollectionsCategories().then(
    (res) => res.categories
  );
  const popularProducts = await getPopularProducts().then(
    (res) => res.products
  );
  const otherCollections = await getOtherCollections().then(
    (res) => res.categories.data
  );

  return {
    props: {
      banners,
      collectionsCategories,
      popularProducts,
      otherCollections,
    },
  };
}
